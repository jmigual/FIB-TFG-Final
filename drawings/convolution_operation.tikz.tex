
\usetikzlibrary{matrix, positioning}
\begin{tikzpicture}
  \matrix (mtr) [matrix of nodes,row sep=-\pgflinewidth, nodes={draw}, ampersand replacement=\&] {
    |[fill=cyan!30]| 0 \& |[fill=cyan!30]| 0 \& |[fill=cyan!30]| 0 \& 
    |[fill=cyan!30]| 0 \& |[fill=cyan!30]| 0 \& |[fill=cyan!30]| 0 \& |[fill=cyan!30]| 0 \\
    |[fill=cyan!30]| 0 \& 0 \& 1 \& |[fill=red!30]| 1 \& 
    |[fill=red!30]| 1 \& |[fill=red!30]| 0 \& |[fill=cyan!30]| 0 \\
    |[fill=cyan!30]| 0 \& 0 \& 0 \& |[fill=red!30]| 1 \& 
    |[fill=red!30]| 1 \& |[fill=red!30]| 1 \& |[fill=cyan!30]| 0 \\
    |[fill=cyan!30]| 0 \& 0 \& 0 \& |[fill=red!30]| 1 \& 
    |[fill=red!30]| 1 \& |[fill=red!30]| 0 \& |[fill=cyan!30]| 0 \\
		|[fill=cyan!30]| 0 \& 0 \& 1 \& 1 \& 0 \& 0 \& |[fill=cyan!30]| 0 \\
		|[fill=cyan!30]| 0 \& 1 \& 1 \& 0 \& 0 \& 0 \& |[fill=cyan!30]| 0 \\
    |[fill=cyan!30]| 0 \& |[fill=cyan!30]| 0 \& |[fill=cyan!30]| 0 \& 
    |[fill=cyan!30]| 0 \& |[fill=cyan!30]| 0 \& |[fill=cyan!30]| 0 \& |[fill=cyan!30]| 0 \\
  };
  \node[right = 0.2em of mtr] (str) {$*$};
	\matrix (K) [right=0.2em of str,matrix of nodes,row sep=-\pgflinewidth, nodes={draw, fill=blue!10}, ampersand replacement=\&]{
		1 \& 0 \& 1 \\
		0 \& 1 \& 0 \\
		1 \& 0 \& 1 \\
  };
  \node [right = 0.2em of K] (eq) {$=$};
	\matrix (ret) [right=0.2em of eq,matrix of nodes,row sep=-\pgflinewidth, nodes={draw}, ampersand replacement=\&] {
    0 \& 2 \& 2 \& 3 \& 1\\
		2 \& 2 \& 4 \& |[fill=green!30]| 3 \& 2\\
		1 \& 2 \& 3 \& 4 \& 1\\
		1 \& 3 \& 3 \& 1 \& 1\\
		2 \& 2 \& 1 \& 1 \& 0\\
  };

  \node [below= 3 em of mtr-5-4.south] (lm) {$\bf I$};
  \node [below = 3 em of K-3-2.south] (lk) {$\bf K$};
	\node [below = 3 em of ret-4-3.south] (lim) {${\bf I} * {\bf K}$};

  \draw[very thick, red] (mtr-2-4.north west) rectangle (mtr-4-6.south east);
	\draw[very thick, green] (ret-2-4.north west) rectangle (ret-1-4.south east);

	\draw[densely dotted, blue, thick] (mtr-2-4.north west) -- (K-1-1.north west);
	\draw[densely dotted, blue, thick] (mtr-4-4.south west) -- (K-3-1.south west);
	\draw[densely dotted, blue, thick] (mtr-2-6.north east) -- (K-1-3.north east);
	\draw[densely dotted, blue, thick] (mtr-4-6.south east) -- (K-3-3.south east);

	\draw[densely dotted, green, thick] (ret-2-4.north west) -- (K-1-1.north west);
	\draw[densely dotted, green, thick] (ret-2-4.south west) -- (K-3-1.south west);
	\draw[densely dotted, green, thick] (ret-2-4.north east) -- (K-1-3.north east);
	\draw[densely dotted, green, thick] (ret-2-4.south east) -- (K-3-3.south east);

  \draw[very thick, blue] (K-1-1.north west) rectangle (K-3-3.south east);

	\node[anchor=south east, inner sep=0.01em, blue] at (mtr-2-4.south east) (xx) {\scalebox{.5}{$\times 1$}};
	\node[anchor=south east, inner sep=0.01em, blue] at (mtr-2-5.south east) (xx) {\scalebox{.5}{$\times 0$}};
	\node[anchor=south east, inner sep=0.01em, blue] at (mtr-2-6.south east) (xx) {\scalebox{.5}{$\times 1$}};
	\node[anchor=south east, inner sep=0.01em, blue] at (mtr-3-4.south east) (xx) {\scalebox{.5}{$\times 0$}};
	\node[anchor=south east, inner sep=0.01em, blue] at (mtr-3-5.south east) (xx) {\scalebox{.5}{$\times 1$}};
	\node[anchor=south east, inner sep=0.01em, blue] at (mtr-3-6.south east) (xx) {\scalebox{.5}{$\times 0$}};
	\node[anchor=south east, inner sep=0.01em, blue] at (mtr-4-4.south east) (xx) {\scalebox{.5}{$\times 1$}};
	\node[anchor=south east, inner sep=0.01em, blue] at (mtr-4-5.south east) (xx) {\scalebox{.5}{$\times 0$}};
  \node[anchor=south east, inner sep=0.01em, blue] at (mtr-4-6.south east) (xx) {\scalebox{.5}{$\times 1$}};
  
  \node [right = .5 of ret] {\(
    \begin{aligned}
      & 1 \cdot 1 + 1 \cdot 0 + 0 \cdot 1\ + \\
      & 1 \cdot 0 + 1 \cdot 1 + 1 \cdot 0\ + \\
      & 1 \cdot 1 + 1 \cdot 0 + 0 \cdot 1 = 3
    \end{aligned}
  \)};
\end{tikzpicture}

